{"ast":null,"code":"import _regeneratorRuntime from\"/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/node_modules/@babel/runtime/helpers/esm/createSuper\";import{Component}from'react';import'./styles.css';import fetchImages from'./services/apiService';import Searchbar from'./components/Searchbar';import ImageGallery from'./components/ImageGallery';import Button from'./components/Button';import Loader from'./components/Loader';import Modal from'./components/Modal/Modal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={images:[],searchQuery:'',page:1,isLoading:false,openModal:false,error:''};_this.maxPages=0;_this.fullImageURL='';_this.newElementHight=0;_this.closeModal=function(){_this.fullImageURL='';_this.setState({openModal:false});};_this.showImageHandler=function(imageUrl){return function(){_this.fullImageURL=imageUrl;_this.setState({openModal:true});};};_this.scrollToHandler=function(){setTimeout(function(){window.scrollTo({top:document.documentElement.scrollHeight,behavior:'smooth'});},750);};_this.searchImagesHandler=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$state,searchQuery,page,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$state=_this.state,searchQuery=_this$state.searchQuery,page=_this$state.page;_this.setState({isLoading:true,error:''});_context.prev=2;_context.next=5;return fetchImages(searchQuery,page);case 5:result=_context.sent;if(result.total!==0){_this.maxPages=Math.ceil(result.totalHits/12);_this.setState(function(_ref2){var images=_ref2.images;return{images:[].concat(_toConsumableArray(images),_toConsumableArray(result.hits))};});}else{// console.log('Not found');\n_this.setState(function(){return{images:[],error:'No results were found for your search.'};});}_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);console.error(_context.t0);_this.setState(function(){return{error:_context.t0.toString()};});case 13:_context.prev=13;_this.setState({isLoading:false});// this.scrollToHandler();\nreturn _context.finish(13);case 16:case\"end\":return _context.stop();}}},_callee,null,[[2,9,13,16]]);}));_this.loadMoreHandler=function(){_this.setState(function(){return{page:Math.min(_this.maxPages,_this.state.page+1)};});};_this.onSubmitHandler=function(searchString){_this.maxPages=0;_this.setState(function(){return{images:[],searchQuery:searchString,page:1};});};return _this;}_createClass(App,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){if(prevState.searchQuery!==this.state.searchQuery&&this.state.searchQuery!==''||prevState.page!==this.state.page){this.searchImagesHandler();// this.scrollToHandler();\n}if(prevState.images.length!==this.state.images.length&&prevState.images.length!==0){// console.log('scrollToHandler App DidUpdate');\nthis.scrollToHandler();}}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Searchbar,{onSubmit:this.onSubmitHandler}),this.state.error?/*#__PURE__*/_jsx(\"p\",{className:\"ErrorText\",children:this.state.error}):/*#__PURE__*/_jsx(ImageGallery,{images:this.state.images,showImageHandler:this.showImageHandler,scrollToHandler:this.scrollToHandler}),this.state.isLoading&&/*#__PURE__*/_jsx(Loader,{}),this.state.page<this.maxPages&&/*#__PURE__*/_jsx(Button,{loadMoreHandler:this.loadMoreHandler}),this.state.openModal&&/*#__PURE__*/_jsx(Modal,{fullImageURL:this.fullImageURL,onClose:this.closeModal})]});}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/src/App.js"],"names":["Component","fetchImages","Searchbar","ImageGallery","Button","Loader","Modal","App","state","images","searchQuery","page","isLoading","openModal","error","maxPages","fullImageURL","newElementHight","closeModal","setState","showImageHandler","imageUrl","scrollToHandler","setTimeout","window","scrollTo","top","document","documentElement","scrollHeight","behavior","searchImagesHandler","result","total","Math","ceil","totalHits","hits","console","toString","loadMoreHandler","min","onSubmitHandler","searchString","prevProps","prevState","length"],"mappings":"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","sourcesContent":["import { Component } from 'react';\nimport './styles.css';\n\nimport fetchImages from './services/apiService';\nimport Searchbar from './components/Searchbar';\nimport ImageGallery from './components/ImageGallery';\nimport Button from './components/Button';\nimport Loader from './components/Loader';\nimport Modal from './components/Modal/Modal';\n\nclass App extends Component {\n  state = {\n    images: [],\n    searchQuery: '',\n    page: 1,\n    isLoading: false,\n    openModal: false,\n    error: '',\n  };\n\n  maxPages = 0;\n  fullImageURL = '';\n  newElementHight = 0;\n\n  componentDidUpdate(prevProps, prevState) {\n    if (\n      (prevState.searchQuery !== this.state.searchQuery && this.state.searchQuery !== '') ||\n      prevState.page !== this.state.page\n    ) {\n      this.searchImagesHandler();\n      // this.scrollToHandler();\n    }\n    if (prevState.images.length !== this.state.images.length && prevState.images.length !== 0) {\n      // console.log('scrollToHandler App DidUpdate');\n      this.scrollToHandler();\n    }\n  }\n\n  closeModal = () => {\n    this.fullImageURL = '';\n    this.setState({ openModal: false });\n  };\n\n  showImageHandler = (imageUrl) => () => {\n    this.fullImageURL = imageUrl;\n    this.setState({ openModal: true });\n  };\n\n  scrollToHandler = () => {\n    setTimeout(() => {\n      window.scrollTo({\n        top: document.documentElement.scrollHeight,\n        behavior: 'smooth',\n      });\n    }, 750);\n  };\n\n  searchImagesHandler = async () => {\n    const { searchQuery, page } = this.state;\n    this.setState({ isLoading: true, error: '' });\n    try {\n      const result = await fetchImages(searchQuery, page);\n\n      if (result.total !== 0) {\n        this.maxPages = Math.ceil(result.totalHits / 12);\n\n        this.setState(({ images }) => ({\n          images: [...images, ...result.hits],\n        }));\n      } else {\n        // console.log('Not found');\n        this.setState(() => ({\n          images: [],\n          error: 'No results were found for your search.',\n        }));\n      }\n    } catch (error) {\n      console.error(error);\n      this.setState(() => ({ error: error.toString() }));\n    } finally {\n      this.setState({ isLoading: false });\n\n      // this.scrollToHandler();\n    }\n  };\n\n  loadMoreHandler = () => {\n    this.setState(() => ({ page: Math.min(this.maxPages, this.state.page + 1) }));\n  };\n\n  onSubmitHandler = (searchString) => {\n    this.maxPages = 0;\n\n    this.setState(() => ({\n      images: [],\n      searchQuery: searchString,\n      page: 1,\n    }));\n  };\n\n  render() {\n    return (\n      <div className=\"App\">\n        <Searchbar onSubmit={this.onSubmitHandler} />\n        {this.state.error ? (\n          <p className=\"ErrorText\">{this.state.error}</p>\n        ) : (\n          <ImageGallery\n            images={this.state.images}\n            showImageHandler={this.showImageHandler}\n            scrollToHandler={this.scrollToHandler}\n          />\n        )}\n        {/* <ImageGallery\n          images={this.state.images}\n          showImageHandler={this.showImageHandler}\n          scrollToHandler={this.scrollToHandler}\n        /> */}\n        {this.state.isLoading && <Loader />}\n        {this.state.page < this.maxPages && <Button loadMoreHandler={this.loadMoreHandler} />}\n        {this.state.openModal && (\n          <Modal fullImageURL={this.fullImageURL} onClose={this.closeModal}></Modal>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}