{"ast":null,"code":"var _jsxFileName = \"/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/src/App.js\";\nimport { Component } from 'react';\nimport './styles.css';\nimport fetchImages from './services/apiService';\nimport Searchbar from './components/Searchbar';\nimport ImageGallery from './components/ImageGallery';\nimport Button from './components/Button';\nimport Loader from './components/Loader';\nimport Modal from './components/Modal/';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      images: [],\n      searchQuery: '',\n      page: 1,\n      isLoading: false,\n      openModal: false,\n      error: ''\n    };\n    this.maxPages = 0;\n    this.fullImageURL = '';\n    this.newElementHight = 0;\n\n    this.closeModal = () => {\n      this.fullImageURL = '';\n      this.setState({\n        openModal: false\n      });\n    };\n\n    this.showImageHandler = imageUrl => () => {\n      this.fullImageURL = imageUrl;\n      this.setState({\n        openModal: true\n      });\n    };\n\n    this.scrollToHandler = () => {\n      setTimeout(() => {\n        window.scrollTo({\n          top: document.documentElement.scrollHeight,\n          behavior: 'smooth'\n        });\n      }, 750);\n    };\n\n    this.searchImagesHandler = async () => {\n      const {\n        searchQuery,\n        page\n      } = this.state;\n      this.setState({\n        isLoading: true,\n        error: ''\n      });\n\n      try {\n        const result = await fetchImages(searchQuery, page);\n\n        if (result.total !== 0) {\n          this.maxPages = Math.ceil(result.totalHits / 12);\n          this.setState(({\n            images\n          }) => ({\n            images: [...images, ...result.hits]\n          }));\n        } else {\n          // console.log('Not found');\n          this.setState(() => ({\n            images: [],\n            error: 'No results were found for your search.'\n          }));\n        }\n      } catch (error) {\n        console.error(error);\n        this.setState(() => ({\n          error: error.toString()\n        }));\n      } finally {\n        this.setState({\n          isLoading: false\n        }); // this.scrollToHandler();\n      }\n    };\n\n    this.loadMoreHandler = () => {\n      this.setState(() => ({\n        page: Math.min(this.maxPages, this.state.page + 1)\n      }));\n    };\n\n    this.onSubmitHandler = searchString => {\n      this.maxPages = 0;\n      this.setState(() => ({\n        images: [],\n        searchQuery: searchString,\n        page: 1\n      }));\n    };\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.searchQuery !== this.state.searchQuery && this.state.searchQuery !== '' || prevState.page !== this.state.page) {\n      this.searchImagesHandler(); // this.scrollToHandler();\n    }\n\n    if (prevState.images.length !== this.state.images.length && prevState.images.length !== 0) {\n      // console.log('scrollToHandler App DidUpdate');\n      this.scrollToHandler();\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(Searchbar, {\n        onSubmit: this.onSubmitHandler\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), this.state.error ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"ErrorText\",\n        children: this.state.error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(ImageGallery, {\n        images: this.state.images,\n        showImageHandler: this.showImageHandler,\n        scrollToHandler: this.scrollToHandler\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }, this), this.state.isLoading && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 34\n      }, this), this.state.page < this.maxPages && /*#__PURE__*/_jsxDEV(Button, {\n        loadMoreHandler: this.loadMoreHandler\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 45\n      }, this), this.state.openModal && /*#__PURE__*/_jsxDEV(Modal, {\n        fullImageURL: this.fullImageURL,\n        onClose: this.closeModal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/maksimcehovskij/Documents/GitHub/React/hw03-image-finder/src/App.js"],"names":["Component","fetchImages","Searchbar","ImageGallery","Button","Loader","Modal","App","state","images","searchQuery","page","isLoading","openModal","error","maxPages","fullImageURL","newElementHight","closeModal","setState","showImageHandler","imageUrl","scrollToHandler","setTimeout","window","scrollTo","top","document","documentElement","scrollHeight","behavior","searchImagesHandler","result","total","Math","ceil","totalHits","hits","console","toString","loadMoreHandler","min","onSubmitHandler","searchString","componentDidUpdate","prevProps","prevState","length","render"],"mappings":"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","sourcesContent":["import { Component } from 'react';\nimport './styles.css';\n\nimport fetchImages from './services/apiService';\nimport Searchbar from './components/Searchbar';\nimport ImageGallery from './components/ImageGallery';\nimport Button from './components/Button';\nimport Loader from './components/Loader';\nimport Modal from './components/Modal/';\n\nclass App extends Component {\n  state = {\n    images: [],\n    searchQuery: '',\n    page: 1,\n    isLoading: false,\n    openModal: false,\n    error: '',\n  };\n\n  maxPages = 0;\n  fullImageURL = '';\n  newElementHight = 0;\n\n  componentDidUpdate(prevProps, prevState) {\n    if (\n      (prevState.searchQuery !== this.state.searchQuery && this.state.searchQuery !== '') ||\n      prevState.page !== this.state.page\n    ) {\n      this.searchImagesHandler();\n      // this.scrollToHandler();\n    }\n    if (prevState.images.length !== this.state.images.length && prevState.images.length !== 0) {\n      // console.log('scrollToHandler App DidUpdate');\n      this.scrollToHandler();\n    }\n  }\n\n  closeModal = () => {\n    this.fullImageURL = '';\n    this.setState({ openModal: false });\n  };\n\n  showImageHandler = (imageUrl) => () => {\n    this.fullImageURL = imageUrl;\n    this.setState({ openModal: true });\n  };\n\n  scrollToHandler = () => {\n    setTimeout(() => {\n      window.scrollTo({\n        top: document.documentElement.scrollHeight,\n        behavior: 'smooth',\n      });\n    }, 750);\n  };\n\n  searchImagesHandler = async () => {\n    const { searchQuery, page } = this.state;\n    this.setState({ isLoading: true, error: '' });\n    try {\n      const result = await fetchImages(searchQuery, page);\n\n      if (result.total !== 0) {\n        this.maxPages = Math.ceil(result.totalHits / 12);\n\n        this.setState(({ images }) => ({\n          images: [...images, ...result.hits],\n        }));\n      } else {\n        // console.log('Not found');\n        this.setState(() => ({\n          images: [],\n          error: 'No results were found for your search.',\n        }));\n      }\n    } catch (error) {\n      console.error(error);\n      this.setState(() => ({ error: error.toString() }));\n    } finally {\n      this.setState({ isLoading: false });\n\n      // this.scrollToHandler();\n    }\n  };\n\n  loadMoreHandler = () => {\n    this.setState(() => ({ page: Math.min(this.maxPages, this.state.page + 1) }));\n  };\n\n  onSubmitHandler = (searchString) => {\n    this.maxPages = 0;\n\n    this.setState(() => ({\n      images: [],\n      searchQuery: searchString,\n      page: 1,\n    }));\n  };\n\n  render() {\n    return (\n      <div className=\"App\">\n        <Searchbar onSubmit={this.onSubmitHandler} />\n        {this.state.error ? (\n          <p className=\"ErrorText\">{this.state.error}</p>\n        ) : (\n          <ImageGallery\n            images={this.state.images}\n            showImageHandler={this.showImageHandler}\n            scrollToHandler={this.scrollToHandler}\n          />\n        )}\n        {/* <ImageGallery\n          images={this.state.images}\n          showImageHandler={this.showImageHandler}\n          scrollToHandler={this.scrollToHandler}\n        /> */}\n        {this.state.isLoading && <Loader />}\n        {this.state.page < this.maxPages && <Button loadMoreHandler={this.loadMoreHandler} />}\n        {this.state.openModal && (\n          <Modal fullImageURL={this.fullImageURL} onClose={this.closeModal}></Modal>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}